<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>RÃ©fÃ©rentiel IngÃ©nierie</title>
<style>
body{font-family:Arial;background:#f4f6f8;margin:0}
header{background:#f37021;color:white;padding:20px;display:flex;gap:20px}
header img{height:70px}
main{padding:30px}
.card{background:white;padding:20px;margin-bottom:20px;border-radius:10px;box-shadow:0 3px 8px rgba(0,0,0,.1)}
button{background:#f37021;color:white;border:none;padding:7px 12px;border-radius:5px;cursor:pointer}
input, select{padding:6px;margin:5px 0}
a{color:#f37021;text-decoration:none}
.danger{background:#c0392b}
</style>
</head>

<body>
<header>
  <img src="/static/oncf.png">
  <div>
    <h2>RÃ©fÃ©rentiel IngÃ©nierie CatÃ©naire & Sous-stations</h2>
    <p>PÃ´le Infrastructure & Circulation</p>
    <p><b>Brahim Ait Lakhyar</b> â€“ ChargÃ© dâ€™Ã©tude catÃ©naire & sous-station</p>
  </div>
</header>

<main>

{% if not role %}
<div class="card" style="max-width:400px;margin:auto">
<form method="post">
<select name="role">
<option value="admin">ADMIN</option>
<option value="pro">PRO</option>
</select>
<input type="password" name="password" placeholder="Mot de passe">
<button>Connexion</button>
</form>
</div>

{% elif not section %}
<div class="card"><h3>ğŸ“ <a href="/browse/catenaire/">CatÃ©naire</a></h3></div>
<div class="card"><h3>âš¡ <a href="/browse/sousstation/">Sous-station</a></h3></div>
<p><a href="/logout">DÃ©connexion</a></p>

{% else %}
<div class="card">
<h3>{{ section.upper() }} / {{ path }}</h3>

{% if parent %}
<a href="/browse/{{ section }}/{{ parent }}">â¬… Retour</a><br><br>
{% endif %}

{% if role=="admin" %}
<form method="post" action="/create-folder">
<input type="hidden" name="section" value="{{ section }}">
<input type="hidden" name="path" value="{{ path }}">
<input name="name" placeholder="Nom dossier">
<button>CrÃ©er dossier</button>
</form>

<form method="post" action="/upload" enctype="multipart/form-data">
<input type="hidden" name="section" value="{{ section }}">
<input type="hidden" name="path" value="{{ path }}">
<input type="file" name="file">
<button>Ajouter fichier</button>
</form>

<form method="post" action="/upload-folder" enctype="multipart/form-data">
<input type="hidden" name="section" value="{{ section }}">
<input type="hidden" name="path" value="{{ path }}">
<input type="file" name="files" webkitdirectory multiple required>
<button>ğŸ“ Importer un dossier complet</button>
</form>
{% endif %}
<form method="post" action="/upload-folder" enctype="multipart/form-data">
  <input type="hidden" name="section" value="{{ section }}">
  <input type="hidden" name="path" value="{{ path }}">
  <input type="file" name="files" webkitdirectory directory multiple required>
  <button>ğŸ“ Importer un dossier complet</button>
</form>

<ul>
{% for i in items %}
<li>
{% if i.is_dir %}
ğŸ“ <a href="/browse/{{ section }}/{{ path }}/{{ i.name }}">{{ i.name }}</a>
{% else %}
ğŸ“„ <a href="/files/{{ section }}/{{ path }}/{{ i.name }}">{{ i.name }}</a>
{% endif %}
{% if role=="admin" %}
<form method="post" action="/delete" style="display:inline">
<input type="hidden" name="section" value="{{ section }}">
<input type="hidden" name="path" value="{{ path }}">
<input type="hidden" name="name" value="{{ i.name }}">
<button class="danger">âœ–</button>
</form>
{% endif %}
</li>
{% endfor %}
</ul>
</div>
{% endif %}

</main>
</body>
</html>